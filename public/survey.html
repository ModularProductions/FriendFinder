<!doctype html>
<html lang="en">
<head>  
  <title></title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="MTH">
  <meta name="keywords" content="">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <style>
    .name {
      font-weight: "bold";
      font-size: 2em;
    }

    .image {
      width: 50%;
    }

    #userImage {
      display: inline-block;
    }

    #matchImage {
      display: inline-block;
    }

    td {
      padding: 0 .5em;
    }

    input[type=radio] {
      margin-right: .25em;
    }
  </style>
  <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
  <![endif]-->
</head>
<body>
  <div id="wrap">
    <div class="container">
      <div class="container">

      <h2>Self-Reporting Questions</h2>
      <hr>
  
      <h3><strong>About You</strong></h3>
      <h4>Name (Required)</h4>
      <input type="text" id="name" class="form-control" required="">
  
      <h4>Link to Photo Image (Required)</h4>
      <input type="text" id="photo" class="form-control" required="">
  
      <hr>
  
      <h3><strong>Question 1</strong></h3>
      <h4>Success is based on survival of the fittest; I am not concerned about the losers.</h4>
      <table>
        <tr>
          <td>(Strongly Disagree) <input type="radio" name="q1" value="1">1</td>
          <td><input type="radio" name="q1" value="2">2</td>
          <td><input type="radio" name="q1" value="3">3</td>
          <td><input type="radio" name="q1" value="4">4</td>
          <td><input type="radio" name="q1" value="5">5 (Strongly Agree)</td>
        </tr>
      </table>

      <h3><strong>Question 2</strong></h3>
      <h4>I find myself in the same kinds of trouble, time after time.</h4>
      <table>
        <tr>
          <td>(Strongly Disagree) <input type="radio" name="q2" value="1">1</td>
          <td><input type="radio" name="q2" value="2">2</td>
          <td><input type="radio" name="q2" value="3">3</td>
          <td><input type="radio" name="q2" value="4">4</td>
          <td><input type="radio" name="q2" value="5">5 (Strongly Agree)</td>
        </tr>
      </table>
  
      <h3><strong>Question 3</strong></h3>
      <h4>For me, what's right is whatever I can get away with.</h4>
      <table>
        <tr>
          <td>(Strongly Disagree) <input type="radio" name="q3" value="1">1</td>
          <td><input type="radio" name="q3" value="2">2</td>
          <td><input type="radio" name="q3" value="3">3</td>
          <td><input type="radio" name="q3" value="4">4</td>
          <td><input type="radio" name="q3" value="5">5 (Strongly Agree)</td>
        </tr>
      </table>
  
      <h3><strong>Question 4</strong></h3>
      <h4>I am often bored.</h4>
      <table>
        <tr>
          <td>(Strongly Disagree) <input type="radio" name="q4" value="1">1</td>
          <td><input type="radio" name="q4" value="2">2</td>
          <td><input type="radio" name="q4" value="3">3</td>
          <td><input type="radio" name="q4" value="4">4</td>
          <td><input type="radio" name="q4" value="5">5 (Strongly Agree)</td>
        </tr>
      </table>
  
      <h3><strong>Question 5</strong></h3>
      <h4>In today's world, I feel justified in doing anything I can get away with to succeed.</h4>
      <table>
        <tr>
          <td>(Strongly Disagree) <input type="radio" name="q5" value="1">1</td>
          <td><input type="radio" name="q5" value="2">2</td>
          <td><input type="radio" name="q5" value="3">3</td>
          <td><input type="radio" name="q5" value="4">4</td>
          <td><input type="radio" name="q5" value="5">5 (Strongly Agree)</td>
        </tr>
      </table>
  
      <h3><strong>Question 6</strong></h3>
      <h4>I find that I am able to pursue one goal for a long time.</h4>
      <table>
        <tr>
          <td>(Strongly Disagree) <input type="radio" name="q6" value="1">1</td>
          <td><input type="radio" name="q6" value="2">2</td>
          <td><input type="radio" name="q6" value="3">3</td>
          <td><input type="radio" name="q6" value="4">4</td>
          <td><input type="radio" name="q6" value="5">5 (Strongly Agree)</td>
        </tr>
      </table>
  
      <h3><strong>Question 7</strong></h3>
      <h4>My main purpose in life is getting as many goodies as I can.</h4>
      <table>
        <tr>
          <td>(Strongly Disagree) <input type="radio" name="q7" value="1">1</td>
          <td><input type="radio" name="q7" value="2">2</td>
          <td><input type="radio" name="q7" value="3">3</td>
          <td><input type="radio" name="q7" value="4">4</td>
          <td><input type="radio" name="q7" value="5">5 (Strongly Agree)</td>
        </tr>
      </table>
  
      <h3><strong>Question 8</strong></h3>
      <h4>I don't plan anything very far in advance.</h4>
      <table>
        <tr>
          <td>(Strongly Disagree) <input type="radio" name="q8" value="1">1</td>
          <td><input type="radio" name="q8" value="2">2</td>
          <td><input type="radio" name="q8" value="3">3</td>
          <td><input type="radio" name="q8" value="4">4</td>
          <td><input type="radio" name="q8" value="5">5 (Strongly Agree)</td>
        </tr>
      </table>
  
      <h3><strong>Question 9</strong></h3>
      <h4>Making a lot of money is my most important goal.</h4>
      <table>
        <tr>
          <td>(Strongly Disagree) <input type="radio" name="q9" value="1">1</td>
          <td><input type="radio" name="q9" value="2">2</td>
          <td><input type="radio" name="q9" value="3">3</td>
          <td><input type="radio" name="q9" value="4">4</td>
          <td><input type="radio" name="q9" value="5">5 (Strongly Agree)</td>
        </tr>
      </table>
  
      <h3><strong>Question 10</strong></h3>
      <h4>I quickly lose interest in tasks I start.</h4>
      <table>
        <tr>
          <td>(Strongly Disagree) <input type="radio" name="q10" value="1">1</td>
          <td><input type="radio" name="q10" value="2">2</td>
          <td><input type="radio" name="q10" value="3">3</td>
          <td><input type="radio" name="q10" value="4">4</td>
          <td><input type="radio" name="q10" value="5">5 (Strongly Agree)</td>
        </tr>
      </table>
      <br>
      <br>
  
      <!-- Submit Button -->
      <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit"><i class="fa fa-check-circle" aria-hidden="true"></i>
        Submit</button>
  
      <hr>
    </div>
    <footer class="footer">
      <div class="container">
        <p><a href="/api/data">API Friends List</a> | <a href="#" id="refresh">Revert Friends to Default</a> | <a href="https://github.com/ModularProductions/FriendFinder.git">GitHub Repo</a> | <a href="https://openpsychometrics.org/tests/LSRP.php">Take the full Levenson Self-Report Psychopathy Scale here!</a></p>
      </div>
    </footer>
  </div> <!-- wrap -->

  <div id="matchModal" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title">Best Match</h4>
        </div>
        <div class="modal-body">
          <div id="user">
            <p id="userName" class="name"></p>
            <img id="userImage" class="image"/>
          </div>
          <p><em>meet</em></p>
          <div id="match">
            <img id="matchImage" class="image" />
            <p id="matchName" class="name"></p>
          </div>
        </div>
        
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->
  
  <script 
    src="https://code.jquery.com/jquery-3.2.1.min.js"
    integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
    crossorigin="anonymous">
  </script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  <script type="text/javascript">
    $("#submit").on("click", function() {
      var user = {
        name : $("#name").val().trim(),
        photo : $("#photo").val().trim(),
        scores : [],
      };
      for (var i = 0; i < 10; i++) {
        console.log("value for question "+(i+1)+" =", $("input[name='q"+(i+1)+"']:checked").val());
        if ($("input[name='q"+(i+1)+"']:checked").val() !== undefined) {
          user.scores.push($("input[name='q"+(i+1)+"']:checked").val());
        }
      }
      console.log("log =", user);
      if ($("#name").val() === "") {
        alert("Please enter your name!");
      } else {
        function checkURL(url) {
          return(url.match(/\.(jpeg|jpg|gif|png)$/) != null);
        }
        if ($("#photo").val() === "" || !checkURL($("#photo").val())) {
          alert("Please provide a photo link!");
        } else {
          if (user.scores.length < 10) {
            alert("Please answer all questions!");
          } else {
            console.log("(survey) user =", user);
            $.post({
              url: "/data/friends",
              data: user,
              traditional: true
            }, function(data) {
              $("#userName").text(user.name);
              $("#userImage").attr("src", user.photo);
              $("#matchName").text(data.name);
              $("#matchImage").attr("src", data.photo);
              $("#matchModal").modal("toggle");
              $("#name").val("");
              $("#photo").val("");
              $("input").prop("checked", false);
            }, "json");
          }
        }
      }
    });

    $("#refresh").on("click", function() {
      event.preventDefault();
      $.ajax("data/clear").done(function() {
        alert("Friend array reset to default.");
      });
    })
  </script>

</body>
</html>